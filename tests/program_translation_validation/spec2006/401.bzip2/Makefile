.PHONY: binary objdump mcsema  BZ2_blockSort fallbackSort mainSort mainQSort3 mainSimpleSort mmed3 mainGtU fallbackQSort3 fallbackSimpleSort compressStream myfeof uInt64_from_UInt32s uInt64_to_double uInt64_toAscii configError outOfMemory ioError panic showFileNames cleanUpAndFail setExit uInt64_qrm10 uInt64_isZero uncompressStream crcError compressedStreamEOF cadvise BZ2_bz__AssertH__fail BZ2_bzlibVersion BZ2_bzCompressInit bz_config_ok default_bzalloc default_bzfree init_RL prepare_new_block BZ2_bzCompress handle_compress isempty_RL copy_output_until_stop copy_input_until_stop flush_RL add_pair_to_block BZ2_bzCompressEnd BZ2_bzDecompressInit BZ2_indexIntoF BZ2_bzDecompress unRLE_obuf_to_output_SMALL unRLE_obuf_to_output_FAST BZ2_bzDecompressEnd BZ2_bzWriteOpen BZ2_bzWrite BZ2_bzWriteClose BZ2_bzWriteClose64 BZ2_bzReadOpen BZ2_bzReadClose BZ2_bzRead myfeof.39 BZ2_bzReadGetUnused BZ2_bzBuffToBuffCompress BZ2_bzBuffToBuffDecompress BZ2_bzopen bzopen_or_bzdopen BZ2_bzdopen BZ2_bzread BZ2_bzwrite BZ2_bzflush BZ2_bzclose BZ2_bzerror BZ2_bsInitWrite BZ2_compressBlock bsPutUChar bsPutUInt32 bsW generateMTFValues sendMTFValues bsFinishWrite makeMaps_e BZ2_decompress makeMaps_d BZ2_hbMakeCodeLengths BZ2_hbAssignCodes BZ2_hbCreateDecodeTables ran spec_init spec_random_load spec_load spec_read spec_fread spec_getc spec_ungetc spec_rewind spec_reset spec_write spec_fwrite spec_putc main debug_time spec_initbufs spec_compress spec_uncompress

ifndef BIN_OPT
  BIN_OPT=O0
  INDIR=binary/
else
  ifeq (${BIN_OPT},O0)
    INDIR=binary/
  else
    INDIR=binary_${BIN_OPT}/
  endif
endif


all: binary objdump mcsema  BZ2_blockSort fallbackSort mainSort mainQSort3 mainSimpleSort mmed3 mainGtU fallbackQSort3 fallbackSimpleSort compressStream myfeof uInt64_from_UInt32s uInt64_to_double uInt64_toAscii configError outOfMemory ioError panic showFileNames cleanUpAndFail setExit uInt64_qrm10 uInt64_isZero uncompressStream crcError compressedStreamEOF cadvise BZ2_bz__AssertH__fail BZ2_bzlibVersion BZ2_bzCompressInit bz_config_ok default_bzalloc default_bzfree init_RL prepare_new_block BZ2_bzCompress handle_compress isempty_RL copy_output_until_stop copy_input_until_stop flush_RL add_pair_to_block BZ2_bzCompressEnd BZ2_bzDecompressInit BZ2_indexIntoF BZ2_bzDecompress unRLE_obuf_to_output_SMALL unRLE_obuf_to_output_FAST BZ2_bzDecompressEnd BZ2_bzWriteOpen BZ2_bzWrite BZ2_bzWriteClose BZ2_bzWriteClose64 BZ2_bzReadOpen BZ2_bzReadClose BZ2_bzRead myfeof.39 BZ2_bzReadGetUnused BZ2_bzBuffToBuffCompress BZ2_bzBuffToBuffDecompress BZ2_bzopen bzopen_or_bzdopen BZ2_bzdopen BZ2_bzread BZ2_bzwrite BZ2_bzflush BZ2_bzclose BZ2_bzerror BZ2_bsInitWrite BZ2_compressBlock bsPutUChar bsPutUInt32 bsW generateMTFValues sendMTFValues bsFinishWrite makeMaps_e BZ2_decompress makeMaps_d BZ2_hbMakeCodeLengths BZ2_hbAssignCodes BZ2_hbCreateDecodeTables ran spec_init spec_random_load spec_load spec_read spec_fread spec_getc spec_ungetc spec_rewind spec_reset spec_write spec_fwrite spec_putc main debug_time spec_initbufs spec_compress spec_uncompress
compd: BZ2_blockSort fallbackSort mainSort mainQSort3 mainSimpleSort mmed3 mainGtU fallbackQSort3 fallbackSimpleSort compressStream myfeof uInt64_from_UInt32s uInt64_to_double uInt64_toAscii configError outOfMemory ioError panic showFileNames cleanUpAndFail setExit uInt64_qrm10 uInt64_isZero uncompressStream crcError compressedStreamEOF cadvise BZ2_bz__AssertH__fail BZ2_bzlibVersion BZ2_bzCompressInit bz_config_ok default_bzalloc default_bzfree init_RL prepare_new_block BZ2_bzCompress handle_compress isempty_RL copy_output_until_stop copy_input_until_stop flush_RL add_pair_to_block BZ2_bzCompressEnd BZ2_bzDecompressInit BZ2_indexIntoF BZ2_bzDecompress unRLE_obuf_to_output_SMALL unRLE_obuf_to_output_FAST BZ2_bzDecompressEnd BZ2_bzWriteOpen BZ2_bzWrite BZ2_bzWriteClose BZ2_bzWriteClose64 BZ2_bzReadOpen BZ2_bzReadClose BZ2_bzRead myfeof.39 BZ2_bzReadGetUnused BZ2_bzBuffToBuffCompress BZ2_bzBuffToBuffDecompress BZ2_bzopen bzopen_or_bzdopen BZ2_bzdopen BZ2_bzread BZ2_bzwrite BZ2_bzflush BZ2_bzclose BZ2_bzerror BZ2_bsInitWrite BZ2_compressBlock bsPutUChar bsPutUInt32 bsW generateMTFValues sendMTFValues bsFinishWrite makeMaps_e BZ2_decompress makeMaps_d BZ2_hbMakeCodeLengths BZ2_hbAssignCodes BZ2_hbCreateDecodeTables ran spec_init spec_random_load spec_load spec_read spec_fread spec_getc spec_ungetc spec_rewind spec_reset spec_write spec_fwrite spec_putc main debug_time spec_initbufs spec_compress spec_uncompress
compd_opt: BZ2_blockSort fallbackSort mainSort mainQSort3 mainSimpleSort mmed3 mainGtU fallbackQSort3 fallbackSimpleSort compressStream myfeof uInt64_from_UInt32s uInt64_to_double uInt64_toAscii configError outOfMemory ioError panic showFileNames cleanUpAndFail setExit uInt64_qrm10 uInt64_isZero uncompressStream crcError compressedStreamEOF cadvise BZ2_bz__AssertH__fail BZ2_bzlibVersion BZ2_bzCompressInit bz_config_ok default_bzalloc default_bzfree init_RL prepare_new_block BZ2_bzCompress handle_compress isempty_RL copy_output_until_stop copy_input_until_stop flush_RL add_pair_to_block BZ2_bzCompressEnd BZ2_bzDecompressInit BZ2_indexIntoF BZ2_bzDecompress unRLE_obuf_to_output_SMALL unRLE_obuf_to_output_FAST BZ2_bzDecompressEnd BZ2_bzWriteOpen BZ2_bzWrite BZ2_bzWriteClose BZ2_bzWriteClose64 BZ2_bzReadOpen BZ2_bzReadClose BZ2_bzRead myfeof.39 BZ2_bzReadGetUnused BZ2_bzBuffToBuffCompress BZ2_bzBuffToBuffDecompress BZ2_bzopen bzopen_or_bzdopen BZ2_bzdopen BZ2_bzread BZ2_bzwrite BZ2_bzflush BZ2_bzclose BZ2_bzerror BZ2_bsInitWrite BZ2_compressBlock bsPutUChar bsPutUInt32 bsW generateMTFValues sendMTFValues bsFinishWrite makeMaps_e BZ2_decompress makeMaps_d BZ2_hbMakeCodeLengths BZ2_hbAssignCodes BZ2_hbCreateDecodeTables ran spec_init spec_random_load spec_load spec_read spec_fread spec_getc spec_ungetc spec_rewind spec_reset spec_write spec_fwrite spec_putc main debug_time spec_initbufs spec_compress spec_uncompress
match: BZ2_blockSort fallbackSort mainSort mainQSort3 mainSimpleSort mmed3 mainGtU fallbackQSort3 fallbackSimpleSort compressStream myfeof uInt64_from_UInt32s uInt64_to_double uInt64_toAscii configError outOfMemory ioError panic showFileNames cleanUpAndFail setExit uInt64_qrm10 uInt64_isZero uncompressStream crcError compressedStreamEOF cadvise BZ2_bz__AssertH__fail BZ2_bzlibVersion BZ2_bzCompressInit bz_config_ok default_bzalloc default_bzfree init_RL prepare_new_block BZ2_bzCompress handle_compress isempty_RL copy_output_until_stop copy_input_until_stop flush_RL add_pair_to_block BZ2_bzCompressEnd BZ2_bzDecompressInit BZ2_indexIntoF BZ2_bzDecompress unRLE_obuf_to_output_SMALL unRLE_obuf_to_output_FAST BZ2_bzDecompressEnd BZ2_bzWriteOpen BZ2_bzWrite BZ2_bzWriteClose BZ2_bzWriteClose64 BZ2_bzReadOpen BZ2_bzReadClose BZ2_bzRead myfeof.39 BZ2_bzReadGetUnused BZ2_bzBuffToBuffCompress BZ2_bzBuffToBuffDecompress BZ2_bzopen bzopen_or_bzdopen BZ2_bzdopen BZ2_bzread BZ2_bzwrite BZ2_bzflush BZ2_bzclose BZ2_bzerror BZ2_bsInitWrite BZ2_compressBlock bsPutUChar bsPutUInt32 bsW generateMTFValues sendMTFValues bsFinishWrite makeMaps_e BZ2_decompress makeMaps_d BZ2_hbMakeCodeLengths BZ2_hbAssignCodes BZ2_hbCreateDecodeTables ran spec_init spec_random_load spec_load spec_read spec_fread spec_getc spec_ungetc spec_rewind spec_reset spec_write spec_fwrite spec_putc main debug_time spec_initbufs spec_compress spec_uncompress

binary:
	mkdir -p ${INDIR}
	/usr/bin/clang-6.0 -${BIN_OPT} -lm -lpthread src/test.ll -o ${INDIR}test

reloc_binary:
	/usr/bin/clang-6.0 -Wl,-emit-relocs -${BIN_OPT} -lm -lpthread src/test.ll -o ${INDIR}test.reloc

objdump:
	objdump -d ${INDIR}test > ${INDIR}/test.objdump

mcsema:
	mcsema-disass --disassembler ${HOME}/ida-6.95/idal64 --os linux --arch amd64_avx --output ${INDIR}test.mcsema.cfg --binary ${INDIR}/test --entrypoint main
	mcsema-lift-4.0 --os linux --arch amd64_avx --cfg ${INDIR}test.mcsema.cfg --output ${INDIR}test.mcsema.bc -disable_dead_store_elimination -disable_optimizer
	llvm-dis ${INDIR}test.mcsema.bc -o ${INDIR}test.mcsema.ll
	../../../scripts/remove_definitions.pl --file ${INDIR}test.mcsema.ll --out ${INDIR}test.mcsema.calls_renamed.ll
	opt -S  -inline   ${INDIR}test.mcsema.calls_renamed.ll -o ${INDIR}test.mcsema.inline.ll


BZ2_blockSort:
	@echo
	${MAKE} -C BZ2_blockSort $(MAKECMDGOALS)
fallbackSort:
	@echo
	${MAKE} -C fallbackSort $(MAKECMDGOALS)
mainSort:
	@echo
	${MAKE} -C mainSort $(MAKECMDGOALS)
mainQSort3:
	@echo
	${MAKE} -C mainQSort3 $(MAKECMDGOALS)
mainSimpleSort:
	@echo
	${MAKE} -C mainSimpleSort $(MAKECMDGOALS)
mmed3:
	@echo
	${MAKE} -C mmed3 $(MAKECMDGOALS)
mainGtU:
	@echo
	${MAKE} -C mainGtU $(MAKECMDGOALS)
fallbackQSort3:
	@echo
	${MAKE} -C fallbackQSort3 $(MAKECMDGOALS)
fallbackSimpleSort:
	@echo
	${MAKE} -C fallbackSimpleSort $(MAKECMDGOALS)
compressStream:
	@echo
	${MAKE} -C compressStream $(MAKECMDGOALS)
myfeof:
	@echo
	${MAKE} -C myfeof $(MAKECMDGOALS)
uInt64_from_UInt32s:
	@echo
	${MAKE} -C uInt64_from_UInt32s $(MAKECMDGOALS)
uInt64_to_double:
	@echo
	${MAKE} -C uInt64_to_double $(MAKECMDGOALS)
uInt64_toAscii:
	@echo
	${MAKE} -C uInt64_toAscii $(MAKECMDGOALS)
configError:
	@echo
	${MAKE} -C configError $(MAKECMDGOALS)
outOfMemory:
	@echo
	${MAKE} -C outOfMemory $(MAKECMDGOALS)
ioError:
	@echo
	${MAKE} -C ioError $(MAKECMDGOALS)
panic:
	@echo
	${MAKE} -C panic $(MAKECMDGOALS)
showFileNames:
	@echo
	${MAKE} -C showFileNames $(MAKECMDGOALS)
cleanUpAndFail:
	@echo
	${MAKE} -C cleanUpAndFail $(MAKECMDGOALS)
setExit:
	@echo
	${MAKE} -C setExit $(MAKECMDGOALS)
uInt64_qrm10:
	@echo
	${MAKE} -C uInt64_qrm10 $(MAKECMDGOALS)
uInt64_isZero:
	@echo
	${MAKE} -C uInt64_isZero $(MAKECMDGOALS)
uncompressStream:
	@echo
	${MAKE} -C uncompressStream $(MAKECMDGOALS)
crcError:
	@echo
	${MAKE} -C crcError $(MAKECMDGOALS)
compressedStreamEOF:
	@echo
	${MAKE} -C compressedStreamEOF $(MAKECMDGOALS)
cadvise:
	@echo
	${MAKE} -C cadvise $(MAKECMDGOALS)
BZ2_bz__AssertH__fail:
	@echo
	${MAKE} -C BZ2_bz__AssertH__fail $(MAKECMDGOALS)
BZ2_bzlibVersion:
	@echo
	${MAKE} -C BZ2_bzlibVersion $(MAKECMDGOALS)
BZ2_bzCompressInit:
	@echo
	${MAKE} -C BZ2_bzCompressInit $(MAKECMDGOALS)
bz_config_ok:
	@echo
	${MAKE} -C bz_config_ok $(MAKECMDGOALS)
default_bzalloc:
	@echo
	${MAKE} -C default_bzalloc $(MAKECMDGOALS)
default_bzfree:
	@echo
	${MAKE} -C default_bzfree $(MAKECMDGOALS)
init_RL:
	@echo
	${MAKE} -C init_RL $(MAKECMDGOALS)
prepare_new_block:
	@echo
	${MAKE} -C prepare_new_block $(MAKECMDGOALS)
BZ2_bzCompress:
	@echo
	${MAKE} -C BZ2_bzCompress $(MAKECMDGOALS)
handle_compress:
	@echo
	${MAKE} -C handle_compress $(MAKECMDGOALS)
isempty_RL:
	@echo
	${MAKE} -C isempty_RL $(MAKECMDGOALS)
copy_output_until_stop:
	@echo
	${MAKE} -C copy_output_until_stop $(MAKECMDGOALS)
copy_input_until_stop:
	@echo
	${MAKE} -C copy_input_until_stop $(MAKECMDGOALS)
flush_RL:
	@echo
	${MAKE} -C flush_RL $(MAKECMDGOALS)
add_pair_to_block:
	@echo
	${MAKE} -C add_pair_to_block $(MAKECMDGOALS)
BZ2_bzCompressEnd:
	@echo
	${MAKE} -C BZ2_bzCompressEnd $(MAKECMDGOALS)
BZ2_bzDecompressInit:
	@echo
	${MAKE} -C BZ2_bzDecompressInit $(MAKECMDGOALS)
BZ2_indexIntoF:
	@echo
	${MAKE} -C BZ2_indexIntoF $(MAKECMDGOALS)
BZ2_bzDecompress:
	@echo
	${MAKE} -C BZ2_bzDecompress $(MAKECMDGOALS)
unRLE_obuf_to_output_SMALL:
	@echo
	${MAKE} -C unRLE_obuf_to_output_SMALL $(MAKECMDGOALS)
unRLE_obuf_to_output_FAST:
	@echo
	${MAKE} -C unRLE_obuf_to_output_FAST $(MAKECMDGOALS)
BZ2_bzDecompressEnd:
	@echo
	${MAKE} -C BZ2_bzDecompressEnd $(MAKECMDGOALS)
BZ2_bzWriteOpen:
	@echo
	${MAKE} -C BZ2_bzWriteOpen $(MAKECMDGOALS)
BZ2_bzWrite:
	@echo
	${MAKE} -C BZ2_bzWrite $(MAKECMDGOALS)
BZ2_bzWriteClose:
	@echo
	${MAKE} -C BZ2_bzWriteClose $(MAKECMDGOALS)
BZ2_bzWriteClose64:
	@echo
	${MAKE} -C BZ2_bzWriteClose64 $(MAKECMDGOALS)
BZ2_bzReadOpen:
	@echo
	${MAKE} -C BZ2_bzReadOpen $(MAKECMDGOALS)
BZ2_bzReadClose:
	@echo
	${MAKE} -C BZ2_bzReadClose $(MAKECMDGOALS)
BZ2_bzRead:
	@echo
	${MAKE} -C BZ2_bzRead $(MAKECMDGOALS)
myfeof.39:
	@echo
	${MAKE} -C myfeof.39 $(MAKECMDGOALS)
BZ2_bzReadGetUnused:
	@echo
	${MAKE} -C BZ2_bzReadGetUnused $(MAKECMDGOALS)
BZ2_bzBuffToBuffCompress:
	@echo
	${MAKE} -C BZ2_bzBuffToBuffCompress $(MAKECMDGOALS)
BZ2_bzBuffToBuffDecompress:
	@echo
	${MAKE} -C BZ2_bzBuffToBuffDecompress $(MAKECMDGOALS)
BZ2_bzopen:
	@echo
	${MAKE} -C BZ2_bzopen $(MAKECMDGOALS)
bzopen_or_bzdopen:
	@echo
	${MAKE} -C bzopen_or_bzdopen $(MAKECMDGOALS)
BZ2_bzdopen:
	@echo
	${MAKE} -C BZ2_bzdopen $(MAKECMDGOALS)
BZ2_bzread:
	@echo
	${MAKE} -C BZ2_bzread $(MAKECMDGOALS)
BZ2_bzwrite:
	@echo
	${MAKE} -C BZ2_bzwrite $(MAKECMDGOALS)
BZ2_bzflush:
	@echo
	${MAKE} -C BZ2_bzflush $(MAKECMDGOALS)
BZ2_bzclose:
	@echo
	${MAKE} -C BZ2_bzclose $(MAKECMDGOALS)
BZ2_bzerror:
	@echo
	${MAKE} -C BZ2_bzerror $(MAKECMDGOALS)
BZ2_bsInitWrite:
	@echo
	${MAKE} -C BZ2_bsInitWrite $(MAKECMDGOALS)
BZ2_compressBlock:
	@echo
	${MAKE} -C BZ2_compressBlock $(MAKECMDGOALS)
bsPutUChar:
	@echo
	${MAKE} -C bsPutUChar $(MAKECMDGOALS)
bsPutUInt32:
	@echo
	${MAKE} -C bsPutUInt32 $(MAKECMDGOALS)
bsW:
	@echo
	${MAKE} -C bsW $(MAKECMDGOALS)
generateMTFValues:
	@echo
	${MAKE} -C generateMTFValues $(MAKECMDGOALS)
sendMTFValues:
	@echo
	${MAKE} -C sendMTFValues $(MAKECMDGOALS)
bsFinishWrite:
	@echo
	${MAKE} -C bsFinishWrite $(MAKECMDGOALS)
makeMaps_e:
	@echo
	${MAKE} -C makeMaps_e $(MAKECMDGOALS)
BZ2_decompress:
	@echo
	${MAKE} -C BZ2_decompress $(MAKECMDGOALS)
makeMaps_d:
	@echo
	${MAKE} -C makeMaps_d $(MAKECMDGOALS)
BZ2_hbMakeCodeLengths:
	@echo
	${MAKE} -C BZ2_hbMakeCodeLengths $(MAKECMDGOALS)
BZ2_hbAssignCodes:
	@echo
	${MAKE} -C BZ2_hbAssignCodes $(MAKECMDGOALS)
BZ2_hbCreateDecodeTables:
	@echo
	${MAKE} -C BZ2_hbCreateDecodeTables $(MAKECMDGOALS)
ran:
	@echo
	${MAKE} -C ran $(MAKECMDGOALS)
spec_init:
	@echo
	${MAKE} -C spec_init $(MAKECMDGOALS)
spec_random_load:
	@echo
	${MAKE} -C spec_random_load $(MAKECMDGOALS)
spec_load:
	@echo
	${MAKE} -C spec_load $(MAKECMDGOALS)
spec_read:
	@echo
	${MAKE} -C spec_read $(MAKECMDGOALS)
spec_fread:
	@echo
	${MAKE} -C spec_fread $(MAKECMDGOALS)
spec_getc:
	@echo
	${MAKE} -C spec_getc $(MAKECMDGOALS)
spec_ungetc:
	@echo
	${MAKE} -C spec_ungetc $(MAKECMDGOALS)
spec_rewind:
	@echo
	${MAKE} -C spec_rewind $(MAKECMDGOALS)
spec_reset:
	@echo
	${MAKE} -C spec_reset $(MAKECMDGOALS)
spec_write:
	@echo
	${MAKE} -C spec_write $(MAKECMDGOALS)
spec_fwrite:
	@echo
	${MAKE} -C spec_fwrite $(MAKECMDGOALS)
spec_putc:
	@echo
	${MAKE} -C spec_putc $(MAKECMDGOALS)
main:
	@echo
	${MAKE} -C main $(MAKECMDGOALS)
debug_time:
	@echo
	${MAKE} -C debug_time $(MAKECMDGOALS)
spec_initbufs:
	@echo
	${MAKE} -C spec_initbufs $(MAKECMDGOALS)
spec_compress:
	@echo
	${MAKE} -C spec_compress $(MAKECMDGOALS)
spec_uncompress:
	@echo
	${MAKE} -C spec_uncompress $(MAKECMDGOALS)
clean:
	rm ${INDIR}test ${INDIR}test.mcsema.* ${INDIR}test.objdump
